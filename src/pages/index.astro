---
---
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AstroLog</title>
  <link rel="stylesheet" href="/style.css" />
  <link rel="manifest" href="/manifest.json" />
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #16161d; color: #eee; margin: 0; }
    header { background: #7e3ff2; padding: 0.6em 1.2em 0 1.2em; }
    .header-main { display: flex; flex-direction: column; }
    .header-row { display: flex; align-items: center; justify-content: space-between; gap: 0.6em; }
    #logo { margin: 0; color: #fff; font-weight: bold; letter-spacing: 2px; }
    .header-controls { display: flex; gap: 0.6em; align-items: center; }
    .header-controls input[type="text"], #searchInput { border-radius: 10px; border: none; padding: 0.4em 0.8em; font-size: 1em; background: #232346; color: #fff; }
    .header-controls button, .lang-btn, .red-btn, .add-btn { border: none; border-radius: 8px; background: #222241; color: #fff; font-weight: bold; padding: 0.4em 0.9em; cursor: pointer; }
    .header-controls button#toggleRedFilter, .red-btn { background: #2e2e50; }
    .header-controls button.active { background: #2e2e50; color: gold; }
    nav.tabs-row { display: flex; justify-content: center; gap: 0.3em; background: #222; padding: 0.5em 0 0.1em 0; border-bottom: 2px solid #7e3ff2; }
    .tab-btn { background: #39396a; color: #fff; border: none; border-radius: 8px 8px 0 0; padding: 0.7em 2em; font-size: 1.05em; cursor: pointer; transition: 0.1s; }
    .tab-btn.active { background: #2e2e50; color: gold; font-weight: bold; border-bottom: 3px solid gold; }
    .content { max-width: 1200px; margin: 2em auto; padding: 0 1em; }
    .tab { display: none; min-height: 60vh; }
    .tab.active { display: block; animation: fadeIn 0.4s; }
    @keyframes fadeIn { from { opacity: 0;} to { opacity: 1; } }
    .filters { margin-bottom: 1em; display: flex; gap: 0.5em; flex-wrap: wrap; }
    .filters button { background: #39396a; border-radius: 12px; border: none; color: #fff; padding: 0.3em 1.1em; cursor: pointer; }
    .filters button.active { background: #2e2e50; color: gold; font-weight: bold; }
    .cards-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.2em; list-style: none; padding: 0; margin: 2em 0 0 0; }
    .cards-list li { background: #191922; border-radius: 18px; box-shadow: 0 2px 12px #0005; overflow: hidden; display: flex; flex-direction: column; align-items: center; padding: 1em 0 0.4em 0; }
    .card-img { width: 100%; display: flex; justify-content: center; align-items: center; min-height: 90px; }
    .card-img img { max-width: 90px; max-height: 90px; object-fit: contain; }
    .card-desc { margin: 0.5em 0 0.7em 0; text-align: center; color: #9fdfff; font-weight: 500; font-size: 1em; }
    @media (max-width: 800px) { .cards-list { grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); } }
    #observationsList { display: flex; flex-wrap: wrap; gap: 1em; }
    .observation-card { background: #232346; border-radius: 14px; box-shadow: 0 1px 8px #0006; padding: 1em; margin-bottom: 1em; flex: 1 1 320px; max-width: 360px; min-width: 250px; display: flex; flex-direction: column; align-items: flex-start; }
    .observation-card .title { font-weight: bold; font-size: 1.07em; margin-bottom: 0.4em; }
    .observation-card img { margin: 0.6em 0; border-radius: 10px; max-width: 98%; max-height: 130px; object-fit: contain; background: #111; }
    .obs-buttons { margin-top: 0.7em; display: flex; gap: 0.6em; }
    .obs-btn { background: #444; color: #fff; border: none; border-radius: 8px; padding: 0.3em 1.2em; font-size: 0.97em; cursor: pointer; }
    .obs-btn.view { background: #565656; }
    .obs-btn.edit { background: #5d5d75; }
    .obs-btn.delete { background: #8d3c3c; }
    .obs-btn.favorite { background: #232346; color: gold; }
    .meteoblue-widgets { display: flex; flex-wrap: wrap; gap: 2em; justify-content: center; align-items: flex-start; margin-top: 1em; }
    .meteoblue-widgets > div { min-width: 280px; }
    @media (max-width: 1000px) { .meteoblue-widgets { flex-direction: column; align-items: stretch; } }
    .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #000a; display: none; align-items: center; justify-content: center; z-index: 2000; }
    .modal.active { display: flex; }
    .modal-content { background: #101021; color: #fff; border-radius: 18px; padding: 2em 1.5em 1.5em; min-width: 270px; max-width: 96vw; box-shadow: 0 2px 24px #000b; position: relative; }
    .modal-content label { display: block; margin-top: 0.9em; }
    .modal-content input, .modal-content select, .modal-content textarea { margin-top: 0.3em; width: 100%; border-radius: 6px; border: 1px solid #39396a; background: #222241; color: #fff; padding: 0.5em; }
    .modal-content button { margin-top: 1em; background: #39396a; color: #fff; border: none; border-radius: 8px; padding: 0.6em 1.2em; cursor: pointer; }
    .modal-content button[type=button] { background: #333; }
    .close { position: absolute; right: 18px; top: 10px; font-size: 2em; cursor: pointer; color: #fff; }
    #configFilterControls { display: flex; align-items: center; gap: 1.5em; margin-top: 2em; }
    #configFilterControls label { font-size: 1.03em; }
    #configFilterControls input[type="checkbox"] { accent-color: #c00; }
    #configFilterControls input[type="range"] { width: 120px; }
    .red-filter { filter: brightness(0.85) sepia(1) hue-rotate(-30deg) saturate(7) brightness(0.68) contrast(1.14); }
    footer { background: #222; color: #eee; display: flex; align-items: center; gap: 1em; justify-content: flex-end; padding: 0.7em 1em; font-size: 0.96em; }
    footer .app-credit { margin-left: auto; color: #aaa; font-size: 0.96em; }
    @media (max-width: 700px) {
      .header-row, .header-controls { flex-direction: column; align-items: stretch; gap: 0.6em; }
      nav.tabs-row { flex-direction: column; gap: 0.2em; }
      .content { padding: 0 0.3em; }
      .meteoblue-widgets { flex-direction: column; gap: 1em; }
    }
  </style>
</head>
<body>
  <!-- Barra Superior: Linha 1 (S√≥ o t√≠tulo AstroLog) -->
      <div class="logo" style="font-size: 2rem; letter-spacing: 2px;">AstroLog</div>
    </header>

    <!-- Barra Superior: Linha 2 (Tabs + botoes) -->
  <nav class="tabs-row">
    <ul class="nav-tabs">
      <li><button class="tab-btn active" data-tab="inicio">In√≠cio</button></li>
      <li><button class="tab-btn" data-tab="objectos">Objectos</button></li>
      <li><button class="tab-btn" data-tab="recursos">Recursos</button></li>
      <li><button class="tab-btn" data-tab="links">Links √öteis</button></li>
      <li><button class="tab-btn" data-tab="calendario">Calend√°rio</button></li>
      <li><button class="tab-btn" data-tab="config">Configura√ß√µes</button></li>
    </ul>
	  <div class="header-controls">
	    <input id="searchInput" type="text" placeholder="Pesquisar observa√ß√µes..." />
	    <button id="langToggle" class="lang-btn">EN</button>
	    <button id="redFilterBtn" class="red-filter-btn" title="Filtro Vermelho"></button>
	    <button id="addObservationBtn" title="Adicionar Observa√ß√£o">Ôºã</button>
	  </div>
	</nav>
  </header>

  <div class="content">

    <!-- IN√çCIO -->
    <section id="tab-inicio-content" class="tab-content active">
      <h2 id="inicio-astroapi-title">Mapa do c√©u</h2>
      <div id="inicio-astroapi">
        <div style="display:flex; flex-direction:column; gap:0.6em;">
          <div>
            <span id="inicio-localidade">Lisboa, Portugal</span>
            <button id="btn-alterar-local">Alterar</button>
          </div>
          <div>
            <span id="inicio-date">2024-06-07</span>
            <button id="inicio-edit-date">Editar Data</button>
            <input id="inicio-date-input" type="date" style="display:none;" />
          </div>
        </div>
		
		<div id="obsFinderBox" style="margin: 2em 0; background: #222241; border-radius: 1em; padding: 1em 1.5em;">
		  <label for="obsDateTime">Data/Hora:</label>
		  <input id="obsDateTime" type="datetime-local" style="margin-right:1em;"/>
		  <label for="obsLat">Lat:</label>
		  <input id="obsLat" type="number" step="0.01" style="width: 90px;" />
		  <label for="obsLng">Lng:</label>
		  <input id="obsLng" type="number" step="0.01" style="width: 90px;" />
		  <button id="obsGeoBtn" title="Usar localiza√ß√£o atual">üìç</button>
		  <button id="obsRefreshBtn" title="Agora">Agora</button>
		  <br>
		  <label for="obsObjectSelect" style="margin-top: 1em;">Objetos observ√°veis nas pr√≥ximas 24h:</label>
		  <select id="obsObjectSelect" style="min-width:250px"></select>
		  <button id="obsShowDetailsBtn">Detalhes</button>
		  <div id="obsCard" style="margin-top: 1em;"></div>
		</div>

		
        <div class="meteoblue-widgets">
	    <!-- widgets Meteoblue mantidos -->
	    <div>
	      <iframe src="https://www.meteoblue.com/pt/tempo/widget/three?geoloc=detect&nocurrent=0&noforecast=0&days=4&tempunit=CELSIUS&windunit=KILOMETER_PER_HOUR&layout=image"
	        frameborder="0" scrolling="NO" allowtransparency="true"
	        sandbox="allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox"
	        style="width: 460px; height: 590px"></iframe>
	      <div>
	        <a href="https://www.meteoblue.com/pt/tempo/semana/index?utm_source=three_widget&utm_medium=linkus&utm_content=three&utm_campaign=Weather%2BWidget"
	           target="_blank" rel="noopener">meteoblue</a>
	      </div>
	    </div>
	    <div>
	      <iframe src="https://www.meteoblue.com/pt/tempo/widget/seeing?geoloc=detect&noground=0"
	        frameborder="0" scrolling="NO" allowtransparency="true"
	        sandbox="allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox"
	        style="width: 520px; height: 775px"></iframe>
	      <div>
	        <a href="https://www.meteoblue.com/pt/tempo/previsao/seeing?utm_source=seeing_widget&utm_medium=linkus&utm_content=seeing&utm_campaign=Weather%2BWidget"
	           target="_blank" rel="noopener">meteoblue</a>
	      </div>
	    </div>
	    <div>
	      <iframe src="https://www.meteoblue.com/pt/tempo/mapas/widget?windAnimation=1&gust=1&satellite=1&cloudsAndPrecipitation=1&temperature=1&sunshine=1&extremeForecastIndex=1&geoloc=detect&tempunit=C&windunit=km%252Fh&lengthunit=metric&zoom=5&autowidth=manu"
	        frameborder="0" scrolling="NO" allowtransparency="true"
	        sandbox="allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox"
	        style="width: 500px; height: 720px"></iframe>
	      <div>
	        <a href="https://www.meteoblue.com/pt/tempo/mapas/index?utm_source=map_widget&utm_medium=linkus&utm_content=map&utm_campaign=Weather%2BWidget"
	           target="_blank" rel="noopener">meteoblue</a>
	      </div>
          </div>
        </div>
        <!-- Eventos e objetos -->
        </div>
        <div id="inicio-previsao"></div>
        <div>
          <h3 id="inicio-eventos-title">Eventos astron√≥micos</h3>
          <ul id="eventos-list"></ul>
        </div>
        <div>
          <h3 id="inicio-objetos-title">Objetos vis√≠veis</h3>
          <ul id="objetos-list"></ul>
        </div>
        <!-- Autocomplete manual localiza√ß√£o -->
        <div id="local-autocomplete-wrapper" style="display:none; background: #1c1c33; padding: 1em; border-radius: 12px;">
          <input id="local-autocomplete" placeholder="Pesquisar localidade..." autocomplete="off" />
          <div id="autocomplete-results"></div>
        </div>
      </div>
    </section>

    <!-- OBJECTOS -->
    <section id="tab-objectos-content" class="tab-content">
      <h2 class="section-title">Objectos Observados</h2>
      <div class="filters">
        <button data-filter="todos" class="active">Todos</button>
        <button data-filter="recentes">Recentes</button>
        <button data-filter="favoritos">Favoritos</button>
        <button id="filterByType">Filtrar por tipo</button>
      </div>
      <input id="searchInput" type="text" placeholder="Pesquisar observa√ß√µes..." />
      <div id="observationsList"></div>
    </section>


    <!-- RECURSOS -->
    <section id="tab-recursos-content" class="tab-content">
      <h2 class="section-title">Recursos</h2>
      <ul class="cards-list">

        <li>
          <a href="https://science.nasa.gov/mission/hubble/science/explore-the-night-sky/hubble-messier-catalog/" target="_blank">
            <div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/8/81/Whirlpool_%28M51%29.jpg" alt="Messier"></div>
            <div class="card-desc">Cat√°logo Messier (NASA/Hubble)</div>
          </a>
        </li>
        <li>
          <a href="https://www.timeanddate.com/moon/phases/" target="_blank">
            <div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/4/49/Monochrome_Moon_%283103771132%29.jpg" alt="Fases da Lua"></div>
            <div class="card-desc">Fases da Lua</div>
          </a>
        </li>
        <li>
          <a href="https://stellarium-web.org/" target="_blank">
            <div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a2/The_Orion.jpg" alt="Stellarium Web"></div>
            <div class="card-desc">Stellarium Web</div>
          </a>
        </li>
      </ul>
    </section>

    <!-- LINKS √öTEIS -->
    <section id="tab-links-content" class="tab-content">
      <h2 class="section-title">Links √öteis</h2>
      <ul class="cards-list">
        <li><a href="https://ptspace.pt/pt/home/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/Portugal_Space_Agency_Logo.png" alt="AEP"></div><div class="card-desc">AEP</div></a></li>
        <li><a href="https://www.esa.int/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/8/80/ESA_logo.svg" alt="ESA"></div><div class="card-desc">ESA</div></a></li>
        <li><a href="https://www.nasa.gov/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/NASA_Worm_logo.svg" alt="NASA"></div><div class="card-desc">NASA</div></a></li>
        <li><a href="https://www.seti.org/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c5/SETI_institute_logo.jpg" alt="SETI"></div><div class="card-desc">SETI</div></a></li>
        <li><a href="https://www.cnsa.gov.cn/english/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/b/b2/Insignia_of_CNSA.svg" alt="CNSA"></div><div class="card-desc">CNSA</div></a></li>
        <li><a href="https://www.gov.br/aeb/pt-br" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/5/59/AEB-Brazil.svg" alt="AEB"></div><div class="card-desc">AEB</div></a></li>
        <li><a href="https://www.asc-csa.gc.ca/eng/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/8/8b/CSA_logo.jpg" alt="CSA"></div><div class="card-desc">CSA</div></a></li>
        <li><a href="https://www.isro.gov.in/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/1/18/Indian_Space_Force.png" alt="ISRO"></div><div class="card-desc">ISRO</div></a></li>
        <li><a href="https://www.spacex.com/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/2/28/Falcon_9_logo_by_SpaceX.png" alt="SpaceX"></div><div class="card-desc">SpaceX</div></a></li>
        <li><a href="https://www.arianespace.com/" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/6/6c/Arianespace_wo_wordmark.svg" alt="Ariane"></div><div class="card-desc">Ariane</div></a></li>
        <li><a href="https://www.blueorigin.com/pt-BR" target="_blank"><div class="card-img"><img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Blue_Origin_updated_logo_2015.svg" alt="Blue Origin"></div><div class="card-desc">Blue Origin</div></a></li>
      </ul>
    </section>

    <!-- CALEND√ÅRIO -->
    <section id="tab-calendario-content" class="tab-content">
      <h2 id="calendarMonthYear">M√™s Ano</h2>
      <div id="calendarHeader">
        <button id="prevMonth">‚Üê</button>
        <span id="calendarMonthYearDisplay"></span>
        <button id="nextMonth">‚Üí</button>
      </div>
      <div id="calendarContainer"></div>
      <div id="calendarResults" style="margin-top: 1rem;"></div>
    </section>

    <!-- CONFIGURA√á√ïES -->
    <section id="tab-config-content" class="tab-content">
      <h2>Configura√ß√µes</h2>
      <p>Ajustes e configura√ß√µes da aplica√ß√£o.</p>
      <div class="config-actions">
        <button id="exportJson">üì§ Exportar Observa√ß√µes</button>
        <label for="importJson" class="import-label">
          üì• Importar Observa√ß√µes
          <input type="file" id="importJson" accept=".json" style="display: none;" />
        </label>
        <button id="downloadBackup">üíæ Download Backup</button>
      </div>
      <div id="configFilterControls">
        <label for="redFilterToggle">Filtro Vermelho</label>
        <input type="checkbox" id="redFilterToggle" />
        <label for="redFilterIntensity">Intensidade do Filtro</label>
        <input type="range" id="redFilterIntensity" min="0" max="100" value="50" />
      </div>
    </section>
  </div>

  <!-- MODAL ADICIONAR OBSERVA√á√ÉO -->
  <div id="addObservationModal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3 id="addObsTitle">Adicionar Observa√ß√£o</h3>
      <form id="addObservationForm">
        <label id="labelNomeObj">Nome do objeto
          <input name="nome" required />
        </label>
        <label id="labelTipo">Tipo
          <select name="tipo" id="inputTipo" required>
            <option value="Estrela">Estrela</option>
            <option value="Gal√°xia">Gal√°xia</option>
            <option value="Aglomerado">Aglomerado</option>
            <option value="Nebulosa">Nebulosa</option>
            <option value="Sistema Solar">Sistema Solar</option>
            <option value="Outro">Outro</option>
          </select>
        </label>
        <label id="labelData">Data
          <input name="data" type="date" required />
        </label>
        <label id="labelLocalizacao">Localiza√ß√£o
          <input name="local" />
        </label>
        <label id="labelRA">RA
          <input name="ra" />
        </label>
        <label id="labelDEC">DEC
          <input name="dec" />
        </label>
        <label id="labelMagnitude">Magnitude
          <input name="magnitude" type="number"/>
        </label>
        <label id="labelDistancia">Dist√¢ncia
          <input name="distancia" />
          <select name="unidadeDistancia" id="inputUnidadeDistancia">
            <option value="ly">ly</option>
            <option value="AU">AU</option>
          </select>
        </label>
        <label id="labelDescricao">Descri√ß√£o
          <textarea name="descricao"></textarea>
        </label>
        <label id="labelFavorito">
          <input type="checkbox" name="favorito" /> Favorito
        </label>
        <label id="labelImagem">Imagem
          <input type="file" name="imagem" accept="image/*" />
        </label>
        <div style="margin-top:1rem; display:flex; gap:0.5rem;">
          <button type="submit" id="btnSave">Guardar</button>
          <button type="button" id="btnCancel">Cancelar</button>
        </div>
        <span id="addSuccessMsg" style="display:none;"></span>
        <button id="closeAddModal" type="button" style="margin-top:1rem;">Fechar</button>
      </form>
    </div>
  </div>

  <footer>
    <span class="app-credit">AstroLog ¬© 2024</span>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/astronomy.min.js"></script>
  <script defer src="/js/obs.js"></script>
  <script defer src="/app.js"></script>
  
</body>
</html>